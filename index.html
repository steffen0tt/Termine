<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kita-Termine 2025</title>
<style>
:root{
  --bg:#fbfbfd; --card:#ffffff; --text:#263238; --muted:#61717a;
  --accent:#0066c0; --radius:14px; --padding:18px; --gap:16px;
  --pastel-blue:#d8eefe; --pastel-red:#ffd9d9; --pastel-green:#e6f7ea;
  --pastel-orange:#fff0da; --pastel-purple:#f3e9ff;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background:var(--bg);color:var(--text);}
header{
  background:linear-gradient(90deg,#6fb1ff,#9bd1ff);
  padding:28px 16px;text-align:center;
  border-bottom-left-radius:18px;border-bottom-right-radius:18px;color:white;
}
header h1{margin:0;font-size:1.6rem;}
header p{margin:10px 0 0;opacity:0.95;font-size:0.95rem;}
nav{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:14px;}
.filter-btn{
  background:white;border-radius:999px;padding:8px 12px;
  font-weight:700;border:1px solid rgba(0,0,0,0.06);
  cursor:pointer;transition:all .2s ease;
}
.filter-btn.active{
  background:var(--accent);color:white;
  box-shadow:0 6px 18px rgba(0,0,0,0.1);
  transform:translateY(-2px);
}
main{max-width:1100px;margin:20px auto;padding:18px;}
.month{margin-bottom:26px;}
.month h2{margin:6px 6px 12px;font-size:1.05rem;color:#233444;display:flex;align-items:center;gap:8px;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:var(--gap);}
.card{background:var(--card);border-radius:var(--radius);padding:14px;box-shadow:0 6px 18px rgba(20,40,60,0.06);display:flex;flex-direction:column;gap:10px;transition:transform .14s ease;min-height:120px;}
.card:hover{transform:translateY(-6px);box-shadow:0 14px 30px rgba(20,40,60,0.08);}
.row{display:flex;justify-content:space-between;align-items:flex-start;gap:10px;}
.title{font-weight:600;font-size:1rem;color:var(--text);}
.meta{font-size:0.92rem;color:var(--muted);}
.time{font-weight:700;color:#223344;}
.pill{padding:6px 10px;border-radius:999px;font-size:0.78rem;font-weight:600;display:inline-flex;gap:8px;align-items:center;}
.type-parents{background:var(--pastel-blue);color:#064b8b;}
.type-closed{background:var(--pastel-red);color:#8b1d1d;}
.type-party{background:var(--pastel-green);color:#13522a;}
.type-info{background:var(--pastel-orange);color:#6a3f00;}
.type-other{background:var(--pastel-purple);color:#4b2a7a;}
.buttons{margin-top:auto;display:flex;gap:8px;flex-wrap:wrap;}
.btn{
  background:linear-gradient(180deg,#ffffff,#f6f8ff);
  border:1px solid rgba(0,0,0,0.06);
  padding:8px 12px;border-radius:10px;
  font-weight:600;font-size:0.9rem;color:var(--accent);
  text-decoration:none;display:inline-flex;gap:8px;align-items:center;
}
.btn-ical{background:linear-gradient(180deg,#fff,#f7fff8);color:#0a7a3f;border-color:rgba(10,122,63,0.12);}
.btn-google{background:linear-gradient(180deg,#fff,#f2f6ff);color:#134f9c;border-color:rgba(19,79,156,0.12);}
.btn-outlook{background:linear-gradient(180deg,#fff,#eef5ff);color:#0057ae;border-color:rgba(0,87,174,0.12);}
footer{text-align:center;color:var(--muted);font-size:0.9rem;margin:28px auto 60px;}
@media (max-width:520px){header h1{font-size:1.2rem;} .card{padding:12px;} main{padding:12px;}}
</style>
</head>
<body>
<header>
  <h1>üß° Kita-Termine 2025</h1>
  <p class="sub">Monats√ºbersicht ¬∑ iCal/Google/Outlook ¬∑ Erinnerung 2 Tage vorher</p>
  <div style="margin-top:12px">
    <a id="feed-download" href="#" style="color:rgba(255,255,255,0.95);text-decoration:underline;margin-right:16px;">üì• Alle Termine als iCal</a>
  </div>
  <nav id="filters">
    <button class="filter-btn active" data-group="all">üåç Alle</button>
    <button class="filter-btn" data-group="Klavierschildkr√∂ten">üê¢ Klavierschildkr√∂ten</button>
    <button class="filter-btn" data-group="Klangkobolde">üßö Klangkobolde</button>
    <button class="filter-btn" data-group="Trompetentiger">üêØ Trompetentiger</button>
    <button class="filter-btn" data-group="Fl√∂tenfohlen">üê¥ Fl√∂tenfohlen</button>
    <button class="filter-btn" data-group="Melodiezauberer">‚ú® Melodiezauberer</button>
    <button class="filter-btn" data-group="Musikwichtel">üéµ Musikwichtel</button>
  </nav>
</header>

<main id="main"></main>

<footer>¬© Kita ¬∑ Stand: 2025 ¬∑ Zeitzone: <strong>Europe/Berlin</strong></footer>

<script>
/* === BASISDATEN === */
const events = [
  { title: "Neujahrskonzert", start: "2025-01-25T15:00:00", end: "2025-01-25T17:00:00" },
  { title: "Elternabend Fl√∂tenfohlen", start: "2025-02-05T18:00:00", end: "2025-02-05T19:00:00" },
  { title: "Kita geschlossen! Sommerschlie√üzeit", start: "2025-08-04", end: "2025-08-15" }
];
const groups = ["Klavierschildkr√∂ten","Klangkobolde","Trompetentiger","Fl√∂tenfohlen","Melodiezauberer","Musikwichtel"];
function toDate(s){return s.includes("T")?new Date(s):new Date(s+"T00:00:00");}
function pad(n){return n.toString().padStart(2,"0");}
function toICSDateTimeLocal(s){if(!s.includes("T"))return s.replace(/-/g,"");const d=new Date(s);return`${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}T${pad(d.getHours())}${pad(d.getMinutes())}${pad(d.getSeconds())}`;}
function utcNowICS(){return toICSDateTimeLocal(new Date().toISOString());}

/* === VEVENT MIT ERINNERUNG === */
function createVEvent(ev){
  const uid=`${Date.now()}-${Math.random().toString(36).slice(2,9)}@kitatermine.local`;
  const dtstamp=utcNowICS();
  if(!ev.start.includes("T")){
    const startY=ev.start.replace(/-/g,"");
    const endDate=new Date(ev.end+"T00:00:00");
    endDate.setDate(endDate.getDate()+1);
    const endY=endDate.toISOString().slice(0,10).replace(/-/g,"");
    return[
      "BEGIN:VEVENT",
      `UID:${uid}`,
      `DTSTAMP:${dtstamp}`,
      `DTSTART;VALUE=DATE:${startY}`,
      `DTEND;VALUE=DATE:${endY}`,
      `SUMMARY:${ev.title}`,
      "BEGIN:VALARM",
      "TRIGGER:-P2D",
      "ACTION:DISPLAY",
      "DESCRIPTION:Erinnerung: Termin in 2 Tagen",
      "END:VALARM",
      "END:VEVENT"
    ].join("\r\n");
  } else {
    const dtStart=toICSDateTimeLocal(ev.start);
    const dtEnd=toICSDateTimeLocal(ev.end);
    return[
      "BEGIN:VEVENT",
      `UID:${uid}`,
      `DTSTAMP:${dtstamp}`,
      `DTSTART;TZID=Europe/Berlin:${dtStart}`,
      `DTEND;TZID=Europe/Berlin:${dtEnd}`,
      `SUMMARY:${ev.title}`,
      "BEGIN:VALARM",
      "TRIGGER:-P2D",
      "ACTION:DISPLAY",
      "DESCRIPTION:Erinnerung: Termin in 2 Tagen",
      "END:VALARM",
      "END:VEVENT"
    ].join("\r\n");
  }
}

/* === iCal & Outlook-Datei === */
function buildEventICSDataUrl(ev){
  const content=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Kita//DE",createVEvent(ev),"END:VCALENDAR"].join("\r\n");
  return"data:text/calendar;charset=utf-8,"+encodeURIComponent(content);
}

/* === Google Link === */
function buildGoogleUrl(ev){
  if(!ev.start.includes("T")){
    const startY=ev.start.replace(/-/g,"");
    const endDate=new Date(ev.end+"T00:00:00");endDate.setDate(endDate.getDate()+1);
    const endY=endDate.toISOString().slice(0,10).replace(/-/g,"");
    return`https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(ev.title)}&dates=${startY}/${endY}&ctz=Europe/Berlin&details=${encodeURIComponent("Erinnerung: bitte 2 Tage vorher setzen")}`;
  } else {
    const s=toICSDateTimeLocal(ev.start);const e=toICSDateTimeLocal(ev.end);
    return`https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(ev.title)}&dates=${s}/${e}&ctz=Europe/Berlin&details=${encodeURIComponent("Erinnerung: bitte 2 Tage vorher setzen")}`;
  }
}

/* === Navigation Filter === */
const filterButtons=document.querySelectorAll(".filter-btn");
filterButtons.forEach(btn=>{
  btn.addEventListener("click",()=>{
    filterButtons.forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
  });
});

/* === Karten rendern === */
const main=document.getElementById("main");
events.forEach(ev=>{
  const card=document.createElement("div");
  card.className="card";
  card.innerHTML=`<div class="title">${ev.title}</div>
  <div class="meta">${new Date(ev.start).toLocaleDateString("de-DE")}</div>
  <div class="time">${ev.start.includes("T")?"ab "+new Date(ev.start).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"}):"ganzt√§gig"}</div>`;
  const buttons=document.createElement("div");buttons.className="buttons";

  const aIcal=document.createElement("a");
  aIcal.className="btn btn-ical";aIcal.href=buildEventICSDataUrl(ev);
  aIcal.download=ev.title.replace(/[^\w\d\-_]+/g,"_")+".ics";aIcal.textContent="üìÖ iCal";

  const aOutlook=document.createElement("a");
  aOutlook.className="btn btn-outlook";aOutlook.href=buildEventICSDataUrl(ev);
  aOutlook.download=ev.title.replace(/[^\w\d\-_]+/g,"_")+".ics";aOutlook.textContent="üì® Outlook";

  const aGoogle=document.createElement("a");
  aGoogle.className="btn btn-google";aGoogle.href=buildGoogleUrl(ev);
  aGoogle.target="_blank";aGoogle.rel="noopener noreferrer";aGoogle.textContent="üìÜ Google";

  buttons.append(aIcal,aOutlook,aGoogle);
  card.append(buttons);
  main.append(card);
});
</script>
</body>
</html>
