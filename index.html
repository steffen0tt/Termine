<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Termine 2026</title>
<style>
  :root{
    --bg:#fbfbfd;
    --card:#ffffff;
    --text:#263238;
    --muted:#61717a;
    --accent:#0066c0;
    --radius:14px;
    --padding:18px;
    --gap:16px;
    --pastel-blue:#d8eefe;
    --pastel-red:#ffd9d9;
    --pastel-green:#e6f7ea;
    --pastel-orange:#fff0da;
    --pastel-purple:#f3e9ff;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    background:var(--bg);
    color:var(--text);
  }
  header{
    background:linear-gradient(90deg,#6fb1ff,#9bd1ff);
    padding:28px 16px;
    text-align:center;
    border-bottom-left-radius:18px;
    border-bottom-right-radius:18px;
    color:white;
  }
  header h1{margin:0;font-size:1.6rem;}
  header p{margin:10px 0 0;opacity:0.95;font-size:0.95rem;}
  nav{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-top:14px;}
  .filter-btn{
    background:white;
    border-radius:999px;
    padding:8px 12px;
    font-weight:700;
    border:1px solid rgba(0,0,0,0.06);
    cursor:pointer;
    transition:all 0.2s ease;
  }
  .filter-btn.active{
    background:#004a8f;
    color:white;
    box-shadow:0 4px 10px rgba(0,0,0,0.2);
    transform:translateY(-2px);
  }
  main{max-width:1100px;margin:20px auto;padding:18px;}
  .month{margin-bottom:26px;}
  .month h2{margin:6px 6px 12px;font-size:1.05rem;color:#233444;display:flex;align-items:center;gap:8px;}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:var(--gap);}
  .card{
    background:var(--card);
    border-radius:var(--radius);
    padding:14px;
    box-shadow:0 6px 18px rgba(20,40,60,0.06);
    display:flex;
    flex-direction:column;
    gap:10px;
    transition:transform .14s ease;
    min-height:120px;
  }
  .card:hover{transform:translateY(-6px);box-shadow:0 14px 30px rgba(20,40,60,0.08);}
  .row{display:flex;justify-content:space-between;align-items:flex-start;gap:10px;}
  .title{font-weight:600;font-size:1rem;color:var(--text);}
  .meta{font-size:0.92rem;color:var(--muted);}
  .time{font-weight:700;color:#223344;}
  .pill{padding:6px 10px;border-radius:999px;font-size:0.78rem;font-weight:600;display:inline-flex;gap:8px;align-items:center;}
  .type-parents{background:var(--pastel-blue);color:#064b8b;}
  .type-closed{background:var(--pastel-red);color:#8b1d1d;}
  .type-party{background:var(--pastel-green);color:#13522a;}
  .type-info{background:var(--pastel-orange);color:#6a3f00;}
  .type-other{background:var(--pastel-purple);color:#4b2a7a;}
  .buttons{margin-top:auto;display:flex;gap:8px;flex-wrap:wrap;}
  .btn{
    background:linear-gradient(180deg,#ffffff,#f6f8ff);
    border:1px solid rgba(0,0,0,0.06);
    padding:8px 12px;
    border-radius:10px;
    font-weight:600;
    font-size:0.9rem;
    color:var(--accent);
    text-decoration:none;
    display:inline-flex;
    gap:8px;
    align-items:center;
  }
  .btn-ical{background:linear-gradient(180deg,#fff,#f7fff8);color:#0a7a3f;border-color:rgba(10,122,63,0.12)}
  .btn-google{background:linear-gradient(180deg,#fff,#f2f6ff);color:#134f9c;border-color:rgba(19,79,156,0.12)}
  footer{text-align:center;color:var(--muted);font-size:0.9rem;margin:28px auto 60px;}
  @media(max-width:520px){header h1{font-size:1.2rem}.card{padding:12px}main{padding:12px}}
</style>
</head>
<body>
<header>
  <h1>üß° Finkenau Musikkindergarten - Termine 2026</h1>
  <nav id="filters" aria-label="Gruppen Filter">
    <button class="filter-btn active" data-group="all">üåç Alle</button>
    <button class="filter-btn" data-group="Klavierschildkr√∂ten">üê¢ Klavierschildkr√∂ten</button>
    <button class="filter-btn" data-group="Klangkobolde">üßö Klangkobolde</button>
    <button class="filter-btn" data-group="Trompetentiger">üêØ Trompetentiger</button>
    <button class="filter-btn" data-group="Fl√∂tenfohlen">üê¥ Fl√∂tenfohlen</button>
    <button class="filter-btn" data-group="Melodiezauberer">‚ú® Melodiezauberer</button>
    <button class="filter-btn" data-group="Musikwichtel">üéµ Musikwichtel</button>
  </nav>
</header>

<main id="main"></main>

<footer>¬© Kita ¬∑ Stand: Oktober 2025 ¬∑ Zeitzone: <strong>Europe/Berlin</strong></footer>

<script>
const events = [
  { title: "Neujahrskonzert Kita", start: "2026-01-24", end: "2026-01-24" },
  { title: "Elternabend Fl√∂tenfohlen", start: "2026-02-04T18:00:00", end: "2026-02-04T19:00:00" },
  { title: "Elternabend Trompetentiger", start: "2026-02-05T18:00:00", end: "2026-02-05T19:00:00" },
  { title: "Elternabend Klangkobolde", start: "2026-02-11T18:00:00", end: "2026-02-11T19:00:00" },
  { title: "Elternabend Klavierschildkr√∂ten", start: "2026-02-12T18:00:00", end: "2026-02-12T19:00:00" },
  { title: "Elternrat", start: "2026-02-18T18:00:00", end: "2026-02-18T19:00:00" },
  { title: "Fasching", start: "2026-02-18", end: "2026-02-18" },
  { title: "Kita geschlossen! Konzepttag", start: "2026-02-20", end: "2026-02-20" },
  { title: "Elternabend Melodiezauberer", start: "2026-02-25T18:00:00", end: "2026-02-25T19:00:00" },
  { title: "Elternabend Musikwichtel", start: "2026-02-26T18:00:00", end: "2026-02-26T19:00:00" },
  { title: "Kita geschlossen! Konzepttag", start: "2026-04-13", end: "2026-04-13" },
  { title: "Kita geschlossen! Regenerationstag", start: "2026-05-15", end: "2026-05-15" },
  { title: "Elternrat", start: "2026-05-20T18:00:00", end: "2026-05-20T19:00:00" },
  { title: "Kita geschlossen! Betriebsausflug", start: "2026-06-12", end: "2026-06-12" },
  { title: "Verabschiedung Br√ºckenjahr", start: "2026-06-19", end: "2026-06-19" },
  { title: "Sommerfest (Betreuung bis 13 Uhr)", start: "2026-06-26", end: "2026-06-26" },
  { title: "Kita geschlossen! Sommerschlie√üzeit", start: "2026-07-20", end: "2026-07-31" },
  { title: "Elternabend Fl√∂tenfohlen", start: "2026-09-02T18:00:00", end: "2026-09-02T19:00:00" },
  { title: "Elternabend Trompetentiger", start: "2026-09-03T18:00:00", end: "2026-09-03T19:00:00" },
  { title: "Elternabend Klavierschildkr√∂ten", start: "2026-09-09T18:00:00", end: "2026-09-09T19:00:00" },
  { title: "Elternabend Melodiezauberer", start: "2026-09-10T18:00:00", end: "2026-09-10T19:00:00" },
  { title: "Elternabend Musikwichtel", start: "2026-09-16T18:00:00", end: "2026-09-16T19:00:00" },
  { title: "Elternabend Klangkobolde", start: "2026-09-17T18:00:00", end: "2026-09-17T19:00:00" },
  { title: "Kita geschlossen! Tag der mittelbaren P√§dagogik", start: "2026-09-26", end: "2026-09-26" },
  { title: "Elternrat", start: "2026-09-30T18:00:00", end: "2026-09-30T19:00:00" },
  { title: "Kita geschlossen! Regenerationstag", start: "2026-10-05", end: "2026-10-05" },
  { title: "Herbstbasteln Trompetentiger", start: "2026-11-04T15:00:00", end: "2026-11-04T17:00:00" },
  { title: "Herbstbasteln Klavierschildkr√∂ten", start: "2026-11-05T15:00:00", end: "2026-11-05T17:00:00" },
  { title: "Info-Nachmittag Br√ºckenjahr", start: "2026-11-11T15:00:00", end: "2026-11-11T17:00:00" },
  { title: "Herbstbasteln Fl√∂tenfohlen", start: "2026-11-12T15:00:00", end: "2026-11-12T17:00:00" },
  { title: "Kita geschlossen! Tag der Hamburger Richtlinien", start: "2026-11-13", end: "2026-11-13" },
  { title: "Lichterfest", start: "2026-11-20", end: "2026-11-20" },
  { title: "Adventssingen Musikwichtel & Trompetentiger", start: "2026-12-07T15:00:00", end: "2026-12-07T17:00:00" },
  { title: "Adventssingen Klangkobolde & Klavierschildkr√∂ten", start: "2026-12-09T15:00:00", end: "2026-12-09T17:00:00" },
  { title: "Adventssingen Melodiezauberer & Fl√∂tenfohlen", start: "2026-12-10T15:00:00", end: "2026-12-10T17:00:00" },
  { title: "Kita geschlossen! Winterschlie√üzeit", start: "2026-12-24", end: "2027-01-01" }
];

/* Gruppenfilter */
const groups=["Klavierschildkr√∂ten","Klangkobolde","Trompetentiger","Fl√∂tenfohlen","Melodiezauberer","Musikwichtel"];

function toDate(s){return s.includes("T")?new Date(s):new Date(s+"T00:00:00");}
function monthKey(dt){return dt.toLocaleString("de-DE",{month:"long",year:"numeric"});}
events.sort((a,b)=>toDate(a.start)-toDate(b.start));
const months={};events.forEach(ev=>{const k=monthKey(toDate(ev.start));months[k]=months[k]||[];months[k].push(ev);});

function eventGroups(ev){const title=ev.title.toLowerCase();const m=groups.filter(g=>title.includes(g.toLowerCase()));return m.length?m:["all"];}

function displayDateRange(ev){
  const s=toDate(ev.start),e=toDate(ev.end);
  if(s.toDateString()===e.toDateString())return s.toLocaleDateString("de-DE",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"});
  return `${s.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})} ‚Äì ${e.toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}`;
}
function displayTime(ev){if(ev.start.includes("T"))return`${toDate(ev.start).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})} ‚Äì ${toDate(ev.end).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}`;return"ganzt√§gig";}

function pad(n){return n.toString().padStart(2,"0");}
function toICSDateTimeLocal(s){if(!s.includes("T"))return s.replace(/-/g,"");const d=new Date(s);return`${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}T${pad(d.getHours())}${pad(d.getMinutes())}${pad(d.getSeconds())}`;}
function utcNowICS(){return toICSDateTimeLocal(new Date().toISOString());}

function createVEvent(ev){
  const uid=`${Date.now()}-${Math.random().toString(36).slice(2,9)}@kitatermine.local`;
  const dtstamp=utcNowICS();
  const includeEndDayFully=ev.title.includes("Sommerschlie√üzeit")||ev.title.includes("Winterschlie√üzeit");
  if(!ev.start.includes("T")){
    const startY=ev.start.replace(/-/g,"");
    const endDate=new Date(ev.end+"T00:00:00");
    if(!includeEndDayFully)endDate.setDate(endDate.getDate()+1);
    const endY=endDate.toISOString().slice(0,10).replace(/-/g,"");
    return[
      "BEGIN:VEVENT",
      `UID:${uid}`,
      `DTSTAMP:${dtstamp}`,
      `DTSTART;VALUE=DATE:${startY}`,
      `DTEND;VALUE=DATE:${endY}`,
      `SUMMARY:${ev.title}`,
      "BEGIN:VALARM",
      "TRIGGER:-P2D",
      "ACTION:DISPLAY",
      "DESCRIPTION:Erinnerung: Termin in 2 Tagen",
      "END:VALARM",
      "END:VEVENT"
    ].join("\r\n");
  }else{
    const dtStart=toICSDateTimeLocal(ev.start);
    const dtEnd=toICSDateTimeLocal(ev.end);
    return[
      "BEGIN:VEVENT",
      `UID:${uid}`,
      `DTSTAMP:${dtstamp}`,
      `DTSTART;TZID=Europe/Berlin:${dtStart}`,
      `DTEND;TZID=Europe/Berlin:${dtEnd}`,
      `SUMMARY:${ev.title}`,
      "BEGIN:VALARM",
      "TRIGGER:-P2D",
      "ACTION:DISPLAY",
      "DESCRIPTION:Erinnerung: Termin in 2 Tagen",
      "END:VALARM",
      "END:VEVENT"
    ].join("\r\n");
  }
}

function buildEventICSDataUrl(ev){
  const c=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Kita-Termine//DE",createVEvent(ev),"END:VCALENDAR"].join("\r\n");
  return"data:text/calendar;charset=utf-8,"+encodeURIComponent(c);
}
function buildGoogleUrl(ev){
  if(!ev.start.includes("T")){
    const s=ev.start.replace(/-/g,"");
    const endDate=new Date(ev.end+"T00:00:00");endDate.setDate(endDate.getDate()+1);
    const e=endDate.toISOString().slice(0,10).replace(/-/g,"");
    return`https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(ev.title)}&dates=${s}/${e}&ctz=Europe/Berlin`;
  }
  const s=toDate(ev.start).toISOString().replace(/[-:]/g,"").split(".")[0]+"Z";
  const e=toDate(ev.end).toISOString().replace(/[-:]/g,"").split(".")[0]+"Z";
  return`https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(ev.title)}&dates=${s}/${e}&ctz=Europe/Berlin`;
}
function buildOutlookUrl(ev){
  const c=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Kita-Termine//DE",createVEvent(ev),"END:VCALENDAR"].join("\r\n");
  return"data:text/calendar;charset=utf-8,"+encodeURIComponent(c);
}

/* Rendering */
const main=document.getElementById("main");
for(const [monthName,list]of Object.entries(months)){
  const sec=document.createElement("section");
  sec.className="month";
  const h2=document.createElement("h2");
  h2.textContent=monthName;
  sec.appendChild(h2);
  const grid=document.createElement("div");
  grid.className="grid";
  list.forEach(ev=>{
    const card=document.createElement("div");
    card.className="card";
    const g=eventGroups(ev);
    card.dataset.groups=g.join(",");
    const type=ev.title.includes("geschlossen")?"closed":ev.title.includes("Elternabend")?"parents":ev.title.includes("fest")?"party":ev.title.includes("Info")?"info":"other";
    const pill=document.createElement("span");
    pill.className=`pill type-${type}`;
    pill.textContent=type==="closed"?"üö´ geschlossen":type==="parents"?"üë™ Eltern":type==="party"?"üéâ Fest":type==="info"?"‚ÑπÔ∏è Info":"üìÖ Termin";
    const title=document.createElement("div");title.className="title";title.textContent=ev.title;
    const date=document.createElement("div");date.className="meta";date.textContent=displayDateRange(ev);
    const time=document.createElement("div");time.className="time";time.textContent=displayTime(ev);
    const buttons=document.createElement("div");buttons.className="buttons";
    const aIcal=document.createElement("a");aIcal.className="btn btn-ical";aIcal.href=buildEventICSDataUrl(ev);aIcal.setAttribute("download",ev.title.replace(/[^\w\d\-_]+/g,"_")+".ics");aIcal.textContent="üìÖ iCal";
    const aGoogle=document.createElement("a");aGoogle.className="btn btn-google";aGoogle.href=buildGoogleUrl(ev);aGoogle.target="_blank";aGoogle.textContent="üìÜ Google";
    const aOutlook=document.createElement("a");aOutlook.className="btn";aOutlook.href=buildOutlookUrl(ev);aOutlook.setAttribute("download",ev.title.replace(/[^\w\d\-_]+/g,"_")+"_outlook.ics");aOutlook.innerHTML="üì® Outlook";
    buttons.appendChild(aIcal);buttons.appendChild(aGoogle);buttons.appendChild(aOutlook);
    card.appendChild(pill);card.appendChild(title);card.appendChild(date);card.appendChild(time);card.appendChild(buttons);
    grid.appendChild(card);
  });
  sec.appendChild(grid);
  main.appendChild(sec);
}

/* Filterfunktion */
const filterBtns=document.querySelectorAll(".filter-btn");
filterBtns.forEach(btn=>btn.addEventListener("click",()=>{
  filterBtns.forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
  const g=btn.dataset.group;
  document.querySelectorAll(".card").forEach(c=>{
    if(g==="all"||c.dataset.groups.includes(g)){c.style.display="flex";}
    else{c.style.display="none";}
  });
}));
</script>
</body>
</html>
